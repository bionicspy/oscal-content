{
  "system-security-plan": {
    "uuid": "d1a7c5f5-0f1f-4fd1-8bc1-5f4f4e0e1f21",
    "metadata": {
      "title": "AI Kitchen System Security & Privacy Plan (SSPP)",
      "last-modified": "2025-09-11T20:11:40Z",
      "version": "1.0.0",
      "oscal-version": "1.1.3",
      "props": [
        {
          "name": "keywords",
          "ns": "http://csrc.nist.gov/ns/oscal",
          "value": "MITRE ATLAS, AI security, adversarial machine learning, threats to AI, tactics, techniques, subtechniques, mitigations, STIX 2.1, OSCAL catalog, machine learning security, model attacks"
        },
        {
          "name": "deployment-architecture",
          "ns": "https://example.com/oscal/ai-kitchen",
          "value": "Azure Front Door → Application Gateway (WAF) → API Management → AKS → OpenWebUI → LiteLLM → multiple MCPs"
        }
      ],
      "roles": [
        { "id": "creator", "title": "Content Creator" },
        { "id": "point-of-contact", "title": "Point of Contact" },
        { "id": "system-owner", "title": "System Owner" },
        { "id": "security-operations", "title": "Security Operations" },
        { "id": "platform-engineer", "title": "Platform Engineer" },
        { "id": "oscal-author", "title": "OSCAL Author" }
      ],
      "parties": [
        {
          "uuid": "123e4567-e89b-12d3-a456-426614174000",
          "type": "organization",
          "name": "AI Kitchen Team",
          "short-name": "AIK",
          "email-addresses": [ "security@aik.example" ],
          "links": [
            { "href": "https://example.com/ai-kitchen", "rel": "website" }
          ]
        },
        {
          "uuid": "7525e825-925e-4075-b812-bb514522fb97",
          "type": "organization",
          "name": "University of Toronto",
          "email-addresses": [ "security@utoronto.ca" ],
          "addresses": [
            {
              "addr-lines": [ "University of Toronto", "27 King's College Circle" ],
              "city": "Toronto",
              "state": "ON",
              "postal-code": "M5S",
              "country": "CA"
            }
          ]
        }
      ],
      "responsible-parties": [
        {
          "role-id": "creator",
          "party-uuids": [ "123e4567-e89b-12d3-a456-426614174000" ]
        },
        {
          "role-id": "point-of-contact",
          "party-uuids": [ "123e4567-e89b-12d3-a456-426614174000" ]
        },
        {
          "role-id": "system-owner",
          "party-uuids": [ "123e4567-e89b-12d3-a456-426614174000" ]
        },
        {
          "role-id": "security-operations",
          "party-uuids": [ "123e4567-e89b-12d3-a456-426614174000" ]
        },
        {
          "role-id": "platform-engineer",
          "party-uuids": [ "123e4567-e89b-12d3-a456-426614174000" ]
        },
        {
          "role-id": "oscal-author",
          "party-uuids": [ "7525e825-925e-4075-b812-bb514522fb97" ]
        }
      ]
    },
    "import-profile": {
      "href": "https://example.com/oscal/profiles/ai-kitchen-profile.json"
    },
    "system-characteristics": {
      "system-ids": [
        {
          "identifier-type": "https://ietf.org/rfc/rfc4122",
          "id": "f5b49b2b-5d50-4e54-b5de-94a820b0fa61"
        }
      ],
      "system-name": "AI Kitchen",
      "description": "AI Kitchen provides secure, governed access to LLM applications and tools via Azure Front Door, Application Gateway (WAF), API Management, AKS-hosted microservices, OpenWebUI, LiteLLM proxy, and managed connections to external Model Context Protocol (MCP) providers.",
      "security-sensitivity-level": "moderate",
      "props": [
        {
          "name": "architecture-notes",
          "ns": "https://example.com/oscal/ai-kitchen",
          "value": "Front Door terminates client TLS and enforces WAF at the edge; downstream ingress protected by Application Gateway WAF; API Management provides OAuth2/OIDC, policy enforcement, and throttling; AKS enforces namespace isolation and CIS baseline; OpenWebUI is served over HTTPS; LiteLLM provides provider routing and guardrails (prompt injection/PII redaction)."
        }
      ],
      "system-information": {
        "information-types": [
          {
            "uuid": "f9f5eea3-6a69-4a09-8c7d-1726f6f8b1a1",
            "title": "LLM Prompts and Outputs",
            "description": "End-user prompts, model responses, and application metadata which may include incidental PII.",
            "confidentiality-impact": { "base": "fips-199-moderate" },
            "integrity-impact": { "base": "fips-199-moderate" },
            "availability-impact": { "base": "fips-199-moderate" }
          }
        ]
      },
      "status": { "state": "operational" }
    },
    "system-implementation": {
      "users": [
        {
          "uuid": "f3b5d4c2-5d1c-4b02-b3fa-0e5e0cebe1e5",
          "title": "End Users",
          "short-name": "users",
          "type": "internal",
          "props": [
            { "name": "authn", "ns": "https://example.com/oscal/ai-kitchen", "value": "OIDC via API Management" }
          ]
        }
      ],
      "components": [
        {
          "uuid": "92c6aef2-0f6e-4a3c-86b5-1ac2a4b3a9c1",
          "type": "service",
          "title": "Azure Front Door (WAF)",
          "description": "Global edge, TLS termination, WAF, routing; origin access restricted via Private Link or service tags + X-Azure-FDID verification.",
          "status": { "state": "operational" },
          "props": [
            { "name": "sku", "ns": "https://learn.microsoft.com/azure/frontdoor", "value": "Premium" }
          ]
        },
        {
          "uuid": "0aa0dcc6-bf04-45e6-8b1b-1a2fe2f1f4f0",
          "type": "service",
          "title": "Azure Application Gateway (WAF v2)",
          "description": "Layer-7 load balancer with Web Application Firewall in prevention mode; serves AKS ingress securely.",
          "status": { "state": "operational" },
          "props": [
            { "name": "waf-mode", "ns": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices", "value": "Prevention" }
          ]
        },
        {
          "uuid": "0c1d6bfe-81af-45f9-9c2a-83597d3f6dd8",
          "type": "service",
          "title": "Azure API Management",
          "description": "API gateway with OAuth2/OIDC, mTLS (optional), rate limiting, schema validation, and header/body masking policies.",
          "status": { "state": "operational" },
          "props": [
            { "name": "deployment", "ns": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline", "value": "VNet-integrated" }
          ]
        },
        {
          "uuid": "ab1b5981-1a0f-4ec6-8c4e-7bba367d1ab2",
          "type": "service",
          "title": "Azure Kubernetes Service (AKS)",
          "description": "Cluster hosting OpenWebUI and LiteLLM; applies AKS security baseline and CIS Kubernetes recommendations.",
          "status": { "state": "operational" },
          "props": [
            { "name": "baseline", "ns": "https://learn.microsoft.com/security/benchmark/azure/baselines/azure-kubernetes-service-aks-security-baseline", "value": "MCSB AKS baseline" },
            { "name": "cis", "ns": "https://learn.microsoft.com/azure/aks/cis-kubernetes", "value": "CIS K8s (as applicable for AKS)" }
          ]
        },
        {
          "uuid": "e4f1a4cd-5e0e-4224-9a7d-2d82b2b97c38",
          "type": "software",
          "title": "OpenWebUI",
          "description": "User interface for LLM interactions; served behind HTTPS; follows project security policy and CVE tracking.",
          "status": { "state": "operational" },
          "props": [
            { "name": "security-policy", "ns": "https://docs.openwebui.com/security/", "value": "GitHub Security Advisories" }
          ]
        },
        {
          "uuid": "8d6c2a9e-3f60-4e0f-8a23-2336a62be0f1",
          "type": "software",
          "title": "LiteLLM Proxy",
          "description": "OpenAI-compatible proxy for multi-provider routing; enforces TLS/SSL settings; optional guardrails for prompt injection, PII redaction, and output moderation.",
          "status": { "state": "operational" },
          "props": [
            { "name": "ssl-guidance", "ns": "https://docs.litellm.ai/docs/guides/security_settings", "value": "Custom CA / SSL verify" },
            { "name": "guardrails", "ns": "https://docs.litellm.ai/docs/proxy/guardrails/pillar_security", "value": "Pillar/Pangea integration" }
          ]
        }
      ]
    },
    "control-implementation": {
      "implemented-requirements": [
        {
          "uuid": "31b0c2bb-5df4-4fe6-b87b-7dfb9d3ac5a7",
          "control-id": "ac-3",
          "description": "Access enforcement through APIM OAuth2/OIDC and optional mTLS; Front Door restricts origin access; AKS namespace RBAC and managed identities.",
          "responsible-roles": [
            { "role-id": "platform-engineer" },
            { "role-id": "security-operations" }
          ],
          "by-components": [
            {
              "component-uuid": "0c1d6bfe-81af-45f9-9c2a-83597d3f6dd8",
              "implementation-status": { "state": "implemented" },
              "description": "APIM enforces OIDC, JWT validation, scopes/claims, key vault-backed secrets, and rate limits."
            },
            {
              "component-uuid": "92c6aef2-0f6e-4a3c-86b5-1ac2a4b3a9c1",
              "implementation-status": { "state": "implemented" },
              "description": "Front Door edge policies and WAF enforce request validation; origins restricted with Private Link or FDID check & service tags."
            },
            {
              "component-uuid": "ab1b5981-1a0f-4ec6-8c4e-7bba367d1ab2",
              "implementation-status": { "state": "implemented" },
              "description": "AKS applies RBAC, Workload Identity, and cluster policies consistent with MCSB AKS baseline and CIS guidance."
            }
          ]
        },
        {
          "uuid": "8a12d48c-1b16-4d65-9c3d-79a8a90d3d62",
          "control-id": "sc-7",
          "description": "Boundary protection with WAF at Front Door and Application Gateway; APIM VNet integration and NSG controls; end-to-end TLS.",
          "responsible-roles": [
            { "role-id": "security-operations" }
          ],
          "by-components": [
            {
              "component-uuid": "92c6aef2-0f6e-4a3c-86b5-1ac2a4b3a9c1",
              "implementation-status": { "state": "implemented" },
              "description": "Front Door WAF managed rules; origin hardening as per best practices."
            },
            {
              "component-uuid": "0aa0dcc6-bf04-45e6-8b1b-1a2fe2f1f4f0",
              "implementation-status": { "state": "implemented" },
              "description": "Application Gateway WAF v2 in prevention mode; tuned exclusions managed as code."
            },
            {
              "component-uuid": "0c1d6bfe-81af-45f9-9c2a-83597d3f6dd8",
              "implementation-status": { "state": "implemented" },
              "description": "APIM internal mode (where applicable), TLS only, strict cipher suites."
            }
          ]
        },
        {
          "uuid": "7a0d2a66-cd1f-4f2a-9ee6-6d4cce548e13",
          "control-id": "ra-5",
          "description": "Vulnerability management and baselines: AKS security baseline and CIS checks; OpenWebUI CVE monitoring; LiteLLM security settings.",
          "responsible-roles": [
            { "role-id": "security-operations" },
            { "role-id": "platform-engineer" }
          ],
          "by-components": [
            {
              "component-uuid": "ab1b5981-1a0f-4ec6-8c4e-7bba367d1ab2",
              "implementation-status": { "state": "implemented" },
              "description": "Cluster hardening consistent with AKS baseline and CIS K8s guidance."
            },
            {
              "component-uuid": "e4f1a4cd-5e0e-4224-9a7d-2d82b2b97c38",
              "implementation-status": { "state": "planned" },
              "description": "Track OpenWebUI advisories and apply updates; enforce HTTPS behind reverse proxy."
            },
            {
              "component-uuid": "8d6c2a9e-3f60-4e0f-8a23-2336a62be0f1",
              "implementation-status": { "state": "implemented" },
              "description": "Ensure SSL verify on; optionally integrate guardrails for prompt injection/PII detection."
            }
          ]
        },
        {
          "uuid": "f0da2550-4e00-4b16-94c7-67a6b1e1b6a1",
          "control-id": "si-4",
          "description": "System monitoring using WAF logs (AFD/AppGW), APIM diagnostics, AKS audits; correlation in SIEM; guardrail flags for unsafe content.",
          "responsible-roles": [
            { "role-id": "security-operations" }
          ],
          "by-components": [
            {
              "component-uuid": "92c6aef2-0f6e-4a3c-86b5-1ac2a4b3a9c1",
              "implementation-status": { "state": "implemented" },
              "description": "Front Door WAF logs enabled and shipped to Log Analytics/Sentinel."
            },
            {
              "component-uuid": "0aa0dcc6-bf04-45e6-8b1b-1a2fe2f1f4f0",
              "implementation-status": { "state": "implemented" },
              "description": "Application Gateway WAF diagnostics enabled."
            },
            {
              "component-uuid": "0c1d6bfe-81af-45f9-9c2a-83597d3f6dd8",
              "implementation-status": { "state": "implemented" },
              "description": "APIM diagnostic logs with PII masking policies; rate-limit telemetry."
            },
            {
              "component-uuid": "8d6c2a9e-3f60-4e0f-8a23-2336a62be0f1",
              "implementation-status": { "state": "implemented" },
              "description": "Guardrails log prompt injection/PII detections for correlation."
            }
          ]
        }
      ]
    },
    "back-matter": {
      "resources": [
        {
          "uuid": "b1a2128a-8f99-4f16-bf8b-3fa0c5cc1a12",
          "title": "Protecting controlled information in non-GC systems (ITSP.10.171)",
          "rlinks": [
            {
              "href": "https://www.cyber.gc.ca/en/guidance/protecting-controlled-information-non-government-canada-systems-and-organizations-itsp10171",
              "media-type": "text/html"
            }
          ]
        },
        {
          "uuid": "2a6b0b22-2c81-4c10-b1c6-2e4ac2e72e30",
          "title": "NIST AI RMF 1.0",
          "rlinks": [
            {
              "href": "https://nvlpubs.nist.gov/nistpubs/ai/NIST.AI.100-1.pdf",
              "media-type": "application/pdf"
            }
          ]
        },
        {
          "uuid": "8e5a0f8c-0c1a-4f2a-b116-8f1dc8e68f50",
          "title": "MITRE ATT&CK (Enterprise)",
          "rlinks": [
            { "href": "https://attack.mitre.org/", "media-type": "text/html" }
          ]
        },
        {
          "uuid": "d9b3b3e1-0a3c-4a0a-9a03-9b84ca38e5b7",
          "title": "MITRE ATLAS",
          "rlinks": [
            { "href": "https://atlas.mitre.org/", "media-type": "text/html" }
          ]
        },
        {
          "uuid": "a86a4a30-46b0-4a9b-b703-4a3280138f75",
          "title": "MITRE D3FEND",
          "rlinks": [
            { "href": "https://d3fend.mitre.org/", "media-type": "text/html" }
          ]
        },
        {
          "uuid": "8c6a2a8e-4df4-4f19-8b94-6b4e7d8e6a21",
          "title": "Azure Front Door — Best Practices & Origin Security",
          "rlinks": [
            {
              "href": "https://learn.microsoft.com/en-us/azure/frontdoor/best-practices",
              "media-type": "text/html"
            },
            {
              "href": "https://docs.azure.cn/en-us/frontdoor/origin-security",
              "media-type": "text/html"
            }
          ]
        },
        {
          "uuid": "6b90f0b2-3e7b-4e1a-9fbc-8a6b2d3c8e3d",
          "title": "Application Gateway WAF Best Practices",
          "rlinks": [
            {
              "href": "https://learn.microsoft.com/en-us/azure/web-application-firewall/ag/best-practices",
              "media-type": "text/html"
            }
          ]
        },
        {
          "uuid": "f2e7a5e3-c7d4-4d0c-9ae8-0b17d64c5e9b",
          "title": "Azure API Management Security Baseline",
          "rlinks": [
            {
              "href": "https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/api-management-security-baseline",
              "media-type": "text/html"
            }
          ]
        },
        {
          "uuid": "7f3e5b01-7f41-4e7a-92a4-0f7bbfe3448a",
          "title": "AKS Security Baseline & CIS Kubernetes on AKS",
          "rlinks": [
            {
              "href": "https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/azure-kubernetes-service-aks-security-baseline",
              "media-type": "text/html"
            },
            {
              "href": "https://learn.microsoft.com/en-us/azure/aks/cis-kubernetes",
              "media-type": "text/html"
            }
          ]
        },
        {
          "uuid": "9376b0e6-24f5-4ee1-b8f8-27b1326f81c0",
          "title": "OpenWebUI Security Policy & HTTPS Guidance",
          "rlinks": [
            { "href": "https://docs.openwebui.com/security/", "media-type": "text/html" },
            { "href": "https://docs.openwebui.com/getting-started/advanced-topics/https-encryption/", "media-type": "text/html" }
          ]
        },
        {
          "uuid": "bdb2db5b-fb2a-4a77-a49f-7bb7a86d3f2a",
          "title": "LiteLLM Security & Guardrails",
          "rlinks": [
            { "href": "https://docs.litellm.ai/docs/guides/security_settings", "media-type": "text/html" },
            { "href": "https://docs.litellm.ai/docs/proxy/guardrails/pillar_security", "media-type": "text/html" }
          ]
        }
      ]
    }
  }
}

